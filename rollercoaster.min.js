(function(){function a(){d.width=f.offsetWidth-e.offsetWidth;d.height=e.offsetHeight;d.style.width=d.width+"px";d.style.height=d.height+"px";c()}function c(){var a=l,c=new h(50,d.height/2),b=new h(d.width-50,d.height/2),e=parseInt(k.value,10)-1,f=[];a.e=[];a.d=!1;a.f=-1;for(var b=b.sub(c),g=0;g<=e;g++)f.push(c.add(new h(g/e*b.x,g/e*b.y))),a.e.push(0);a.c=new m(f);n(a)}function b(){window.requestAnimationFrame(b);g.clearRect(0,0,d.width,d.height);p(l)}var e,f,d,g,l,k;window.onload=function(){e=document.getElementById("controls");
d=document.getElementById("main");f=document.getElementById("header");g=d.getContext("2d");l=new q(d);k=document.getElementById("npoints");k.onchange=c;a();window.onresize=a;window.requestAnimationFrame(b)};window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame})();function h(a,c){this.x=a;this.y=c}h.prototype.add=function(a){return new h(this.x+a.x,this.y+a.y)};h.prototype.sub=function(a){return new h(this.x-a.x,this.y-a.y)};function m(a){2<=a.length&&(this.b=a,r(this))}function r(a){a.h=a.b.length-1;var c=a.h-1;a.i=[];for(var b=0;b<=c;b++)a.i.push(a.b[b+1].sub(a.b[b]));c=a.h-2;a.n=[];for(b=0;b<=c;b++)a.n.push(a.i[b+1].sub(a.i[b]))}function s(a,c){var b=new h(0,0);a.b.forEach(function(a,f){for(var d,g=this.h,l=d=1,k=f+1;k<=g;k++)d*=k;g-=f;for(k=2;k<=g;k++)l*=k;d/=l;b=b.add(new h(a.x*d*Math.pow(1-c,this.h-f)*Math.pow(c,f),a.y*d*Math.pow(1-c,this.h-f)*Math.pow(c,f)))},a);return b};function q(a){this.c=null;this.canvas=a;this.a=a.getContext("2d");this.g=[];this.e=[];this.d=!1;this.f=-1;this.canvas.onmousedown=this.q.bind(this);this.canvas.onmouseup=this.s.bind(this);this.canvas.onmousemove=this.r.bind(this);this.m=4;this.l="#000000";this.outlineWidth=2;this.outlineColor="#cccccc";this.j=5;this.o=1.25*this.j;this.u=Math.pow(this.j,2);this.p=Math.pow(this.o,2);this.k=100;this.t=["#ff0000","#ffaa00","#88aa00"]}
function n(a){a.g=[];for(var c=1/a.k,b=0,e=0;e<=a.k;e++)a.g.push(s(a.c,b)),b+=c;r(a.c)}
function p(a){a.a.save();a.a.lineJoin="round";a.a.strokeStyle=a.outlineColor;a.a.lineWidth=a.outlineWidth;a.a.beginPath();a.a.moveTo(a.c.b[0].x,a.c.b[0].y);a.c.b.forEach(function(a){this.a.lineTo(a.x,a.y)},a);a.a.stroke();a.a.strokeStyle=a.l;a.a.lineWidth=a.m;a.a.beginPath();a.a.moveTo(a.g[0].x,a.g[0].y);a.g.forEach(function(a){this.a.lineTo(a.x,a.y)},a);a.a.stroke();a.c.b.forEach(function(a,b){this.a.fillStyle=this.t[this.e[b]];var e=this.a,f=a.x,d=a.y,g=this.j;e.beginPath();e.arc(f,d,g,0,2*Math.PI,
!1);e.fill()},a);a.a.restore()}q.prototype.q=function(a){var c=new h(a.clientX-this.canvas.offsetLeft,a.clientY-this.canvas.offsetTop);this.c.b.some(function(a,e){return Math.pow(c.x-a.x,2)+Math.pow(c.y-a.y,2)<this.p?(this.e[e]=2,this.d=!0,this.f=e,!0):!1},this)};q.prototype.s=function(){!0===this.d&&(this.e[this.f]=1,this.d=!1,this.f=-1)};
q.prototype.r=function(a){var c=new h(a.clientX-this.canvas.offsetLeft,a.clientY-this.canvas.offsetTop);!0===this.d?(this.c.b[this.f]=c,n(this)):!1===this.d&&this.c.b.forEach(function(a,e){this.e[e]=Math.pow(c.x-a.x,2)+Math.pow(c.y-a.y,2)>this.u?0:1},this)};
