(function(){function a(){d.width=window.innerWidth-c.offsetWidth;d.height=c.offsetHeight;d.style.width=d.width+"px";d.style.height=d.height+"px";f.stop();f.r()}function b(a){window.requestAnimationFrame(b);f.s(a)}var c,d,f;window.onload=function(){c=document.getElementById("controls");d=document.getElementById("main");f=new g(d,1E-4,document.getElementById("start"),document.getElementById("stop"),document.getElementById("reset"),document.getElementById("mass"),document.getElementById("grav"),document.getElementById("npoints"));
a();window.onresize=a;window.requestAnimationFrame(b)};window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame})();function k(a,b){this.x=a;this.y=b}k.prototype.add=function(a){return new k(this.x+a.x,this.y+a.y)};k.prototype.sub=function(a){return new k(this.x-a.x,this.y-a.y)};function l(a,b){return new k(a.x*b,a.y*b)};function m(a){2<=a.length&&(this.d=a,n(this))}function n(a){a.g=a.d.length-1;var b=a.g-1;a.o=[];for(var c=0;c<=b;c++)a.o.push(a.d[c+1].sub(a.d[c]));b=a.g-2;a.D=[];for(c=0;c<=b;c++)a.D.push(a.o[c+1].sub(a.o[c]))}m.prototype.f=function(a){var b=new k(0,0);this.d.forEach(function(c,d){b=b.add(l(c,p(this.g,d,a)))},this);return b};function q(a,b){var c=a.g-1,d=new k(0,0);a.o.forEach(function(a,e){d=d.add(l(a,p(c,e,b)))},a);return l(d,a.g)}
function r(a,b){var c=a.g-2,d=new k(0,0);a.D.forEach(function(a,e){d=d.add(l(a,p(c,e,b)))},a);return l(d,a.g*(a.g-1))}function p(a,b,c){for(var d=1,f=1,e=b+1;e<=a;e++)d*=e;for(var e=a-b,h=2;h<=e;h++)f*=h;return d/f*Math.pow(1-c,a-b)*Math.pow(c,b)};function s(a){this.b=null;this.canvas=a;this.a=a.getContext("2d");this.k=[];this.i=[];this.h=!1;this.j=-1;this.canvas.onmousedown=this.N.bind(this);this.canvas.onmouseup=this.P.bind(this);this.canvas.onmousemove=this.O.bind(this);this.I=4;this.H="#073642";this.outlineWidth=2;this.outlineColor="#93a1a1";this.v=6;this.K=1.25*this.v;this.R=Math.pow(this.v,2);this.L=Math.pow(this.K,2);this.G=100;this.Q=["#dc322f","#b58900","#859900"];this.F=50}
function t(a){a.k=[];for(var b=1/a.G,c=0,d=0;d<=a.G;d++)a.k.push(a.b.f(c)),c+=b;n(a.b)}
s.prototype.s=function(a){this.a.save();!0===a&&(this.a.lineJoin="round",this.a.strokeStyle=this.outlineColor,this.a.lineWidth=this.outlineWidth,this.a.beginPath(),this.a.moveTo(this.b.d[0].x,this.b.d[0].y),this.b.d.forEach(function(a){this.a.lineTo(a.x,a.y)},this),this.a.stroke());this.a.strokeStyle=this.H;this.a.lineWidth=this.I;this.a.beginPath();this.a.moveTo(this.k[0].x,this.k[0].y);this.k.forEach(function(a){this.a.lineTo(a.x,a.y)},this);this.a.stroke();!0===a&&this.b.d.forEach(function(a,c){this.a.fillStyle=
this.Q[this.i[c]];var d=this.a,f=a.x,e=a.y,h=this.v;d.beginPath();d.arc(f,e,h,0,2*Math.PI,!1);d.fill()},this);this.a.restore()};s.prototype.N=function(a){var b=new k(a.clientX-this.canvas.offsetLeft,a.clientY-this.canvas.offsetTop);this.b.d.some(function(a,d){return Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2)<this.L?(this.i[d]=2,this.h=!0,this.j=d,!0):!1},this)};s.prototype.P=function(){!0===this.h&&(this.i[this.j]=1,this.h=!1,this.j=-1)};
s.prototype.O=function(a){var b=new k(a.clientX-this.canvas.offsetLeft,a.clientY-this.canvas.offsetTop);!0===this.h?(this.b.d[this.j]=b,t(this)):!1===this.h&&this.b.d.forEach(function(a,d){this.i[d]=Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2)>this.R?0:1},this)};function u(a,b,c){this.f=a;this.c=0;this.y=null;this.B=b;this.m=3<=arguments.length?arguments[2]:void 0}u.prototype.step=function(a){var b=a/2,c=this.f(this.c,this.y,this.m),d=this.f(this.c+b,v(this.y,c,b),this.m),f=this.f(this.c+b,v(this.y,d,b),this.m),e=this.f(this.c+a,v(this.y,f,a),this.m),h=a/6;this.y.forEach(function(a,b,x){x[b]=a+h*(c[b]+2*d[b]+2*f[b]+e[b])},this);this.c+=a};function v(a,b,c){var d=[];a.forEach(function(a,e){d.push(a+b[e]*c)});return d};function g(a,b,c,d,f,e,h,w){this.canvas=a;this.a=this.canvas.getContext("2d");this.A=c;this.A.onclick=this.start.bind(this);this.C=d;this.C.onclick=this.stop.bind(this);this.n=w;this.n.onchange=this.r.bind(this);this.w=f;this.w.onclick=this.r.bind(this);this.t=h;this.u=e;this.p=new s(this.canvas);this.r();this.q={};this.e=new u(y,b,this.q);this.M=10/60;this.l=!1}
g.prototype.r=function(){var a=this.p,b=parseInt(this.n.value,10)-1,c=[];a.i=[];a.h=!1;a.j=-1;for(var d=new k(a.F,a.canvas.height/2),f=(new k(a.canvas.width-a.F,a.canvas.height/2)).sub(d),e=0;e<=b;e++)c.push(d.add(l(f,e/b))),a.i.push(0);a.b=new m(c);t(a)};
g.prototype.start=function(){this.q.b=this.p.b;this.q.J=-1*parseFloat(this.t.value);this.q.S=parseFloat(this.u.value);this.e.c=null;this.e.y=[0,0];this.A.style.display="none";this.C.style.display="inline";this.w.disabled=!0;this.t.disabled=!0;this.u.disabled=!0;this.l=this.n.disabled=!0};g.prototype.stop=function(){this.l=!1;this.C.style.display="none";this.A.style.display="inline";this.w.disabled=!1;this.t.disabled=!1;this.u.disabled=!1;this.n.disabled=!1};
g.prototype.s=function(a){this.a.clearRect(0,0,this.canvas.width,this.canvas.height);this.p.s(!this.l);if(!0===this.l){var b=0.001*a;null===this.e.c&&(this.e.c=b);b-this.e.c>this.M&&(this.e.c=b);a=this.e;for(var c=b-a.c,b=Math.floor(c/a.B),c=c-b*a.B,d=0;d<b;d++)a.step(a.B);a.step(c);1>=this.e.y[0]&&0<=this.e.y[0]?(this.a.fillStyle="#268bd2",c=this.p.b.f(this.e.y[0]),a=this.a,b=c.x,c=c.y,a.beginPath(),a.arc(b,c,10,0,2*Math.PI,!1),a.fill()):this.stop()}};
function y(a,b,c){c.b.f(b[0]);a=q(c.b,b[0]);var d=r(c.b,b[0]);return[b[1],-1/(a.x*a.x+a.y*a.y)*((a.x*d.x+a.y*d.y)*Math.pow(b[1],2)+c.J*a.y)]};
